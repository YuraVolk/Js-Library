class PerspectiveCarousel{constructor(t){let e={},i={};function n(t,n){const r=Math.abs(n);if(r<e.flankingItems+1)var a=i.calculations[r];else a=i.calculations[e.flankingItems+1];const o=Math.pow(e.sizeMultiplier,r),s=o*t.dataset.originalWidth,l=o*t.dataset.originalHeight,c=a.offset;let d,u=a.distance;if(n<0&&(u*=-1),"horizontal"==e.orientation)var m=(h=i.containerWidth/2)+u-s/2,f=e.horizon-c-l/2;else{var h=i.containerHeight/2;m=e.horizon-c-s/2,f=h+u-l/2}d=0===n?1:a.opacity;const g=e.flankingItems+2-r;t.dataset.width=s,t.dataset.height=l,t.dataset.top=f,t.dataset.left=m,t.dataset.oldPosition=t.dataset.currentPosition||0,t.dataset.depth=g,t.dataset.opacity=d}function r(t,r){Math.abs(r)<=e.flankingItems+1?(n(t,r),i.itemsAnimating++,t.style.zIndex=t.dataset.depth,Object.assign(t.style,{left:t.dataset.left+"px",width:t.dataset.width+"px",height:t.dataset.height+"px",top:t.dataset.top+"px",opacity:t.dataset.opacity}),setTimeout((()=>{!function(t,n){i.itemsAnimating--,t.dataset.currentPosition=n,0===n&&(i.currentCenterItem=t),0===i.itemsAnimating&&(i.carouselRotationsLeft-=1,i.currentlyMoving=!1,i.carouselRotationsLeft>0?a():(i.currentSpeed=e.speed,i.currentCenterItem.classList.add(e.activeClassName),!1===i.performingSetup&&(e.movedToCenter(i.currentCenterItem),e.movedFromCenter(i.previousCenterItem)),i.performingSetup=!1))}(t,r)}),300)):(t.dataset.currentPosition=r,0!==t.dataset.oldPosition&&t.dataset.oldPosition||(n(t,r),Object.assign(t.style,{left:t.dataset.left+"px",width:t.dataset.width+"px",height:t.dataset.height+"px",top:t.dataset.top+"px",opacity:t.dataset.opacity,zIndex:t.dataset.depth})))}function a(){if(!1===i.currentlyMoving){i.currentCenterItem.classList.remove(e.activeClassName),i.currentlyMoving=!0,i.itemsAnimating=0,i.carouselRotationsLeft++;for(let t=0;t<i.totalItems;t++){const e=i.items[t],n=parseInt(e.dataset.currentPosition,10);let a;a="forward"==i.currentDirection?n-1:n+1;const o=a>0?i.rightItemsCount:i.leftItemsCount;Math.abs(a)>o&&(a=-1*n,i.totalItems%2==0&&(a+=1)),r(e,a)}}}function o(t){var n,r;!1===i.currentlyMoving&&(i.previousCenterItem=i.currentCenterItem,e.movingFromCenter(i.currentCenterItem),"backward"==t?(e.movingToCenter(((r=i.currentCenterItem.prev()).length<=0&&(r=i.currentCenterItem.parentNode.children.children[length]),r)),i.currentDirection="backward"):"forward"==t&&(e.movingToCenter(((n=i.currentCenterItem.next()).length<=0&&(n=i.currentCenterItem.parentNode.children[0]),n)),i.currentDirection="forward"))}this.reload=function(t){const n={startingItem:1,separation:175,separationMultiplier:.6,horizonOffset:0,horizonOffsetMultiplier:1,sizeMultiplier:.7,opacityMultiplier:.87,horizon:0,speed:280,flankingItems:3,orientation:"horizontal",activeClassName:"perspective-carousel__image--center",preloadImages:!0,forcedImageWidth:0,forcedImageHeight:0,movingToCenter:function(){},movedToCenter:function(){},clickedCenter:function(){},movingFromCenter:function(){},movedFromCenter:function(){},parent:document.querySelector(".perspective-carousel__images"),leftButton:"perspective-carousel__left",rightButton:"perspective-carousel__right",switchOrientationButton:"perspective-carousel__switch3d"};e=function(t){for(var e=1;e<arguments.length;e++)if(arguments[e])for(var i in arguments[e])arguments[e].hasOwnProperty(i)&&(t[i]=arguments[e][i]);return t}({},n,t),function(){const t=window.getComputedStyle(e.parent);i={totalItems:e.parent.children.length,containerWidth:t.width.slice(0,-2),containerHeight:t.height.slice(0,-2),currentCenterItem:null,previousCenterItem:null,items:[],calculations:[],carouselRotationsLeft:0,currentlyMoving:!1,itemsAnimating:0,currentSpeed:e.speed,intervalTimer:null,currentDirection:void 0,leftItemsCount:0,rightItemsCount:0,performingSetup:!0},Array.from(e.parent.querySelectorAll("img")).forEach((t=>{t.classList.remove(e.activeClassName)}))}(),Array.from(e.parent.querySelectorAll("img")).forEach((t=>t.style.display="none")),e.forcedImageWidth&&e.forcedImageHeight&&Array.from(e.parent.querySelectorAll("img")).forEach((function(t){t.style.width=e.forcedImageWidth,t.style.height=e.forcedImageHeight})),function(t){if(!1===e.preloadImages)return void t();const i=Array.from(e.parent.querySelectorAll("img"));let n=0;const r=i.length;i.forEach((function(e){e.setAttribute("src",e.getAttribute("src")),e.style.display="none",e.onload=()=>{e.style.display="",n+=1,n===r&&t()}}))}((function(){Array.from(e.parent.querySelectorAll("img")).forEach((function(t){(null==t.dataset.originalWidth||e.forcedImageWidth>0)&&(t.style.display="",t.dataset.originalWidth=t.clientWidth,t.style.display="none"),(null==t.dataset.originalHeight||e.forcedImageHeight>0)&&(t.style.display="",t.dataset.originalHeight=t.clientHeight,t.style.display="none")})),function(){i.calculations[0]={distance:0,offset:0,opacity:1};let t=e.horizonOffset,n=e.separation;for(let r=1;r<=e.flankingItems+2;r++)r>1&&(t*=e.horizonOffsetMultiplier,n*=e.separationMultiplier),i.calculations[r]={distance:i.calculations[r-1].distance+n,offset:i.calculations[r-1].offset+t,opacity:i.calculations[r-1].opacity*e.opacityMultiplier};e.edgeFadeEnabled?i.calculations[e.flankingItems+1].opacity=0:i.calculations[e.flankingItems+1]={distance:0,offset:0,opacity:0}}(),i.items=Array.from(e.parent.querySelectorAll("img")),0===e.horizon&&("horizontal"===e.orientation?e.horizon=i.containerHeight/2:e.horizon=i.containerWidth/2),e.parent.style.position="relative",Array.from(e.parent.querySelectorAll("img")).forEach((function(t){var n,r;"horizontal"===e.orientation?(n=i.containerWidth/2-t.dataset.originalWidth/2,r=e.horizon-t.dataset.originalHeight/2):(n=e.horizon-t.dataset.originalWidth/2,r=i.containerHeight/2-t.dataset.originalHeight/2),Object.assign(t.style,{left:n,top:r,visibility:"visible",position:"absolute","z-index":0,opacity:0}),t.style.display=""})),function(){e.startingItem=0===e.startingItem?Math.round(i.totalItems/2):e.startingItem,i.rightItemsCount=Math.ceil((i.totalItems-1)/2),i.leftItemsCount=Math.floor((i.totalItems-1)/2),i.carouselRotationsLeft=1,r(i.items[e.startingItem-1],0),i.items[e.startingItem-1].style.opacity=1;let t=e.startingItem-1;for(let e=1;e<=i.rightItemsCount;e++)t<i.totalItems-1?t+=1:t=0,i.items[t].style.opacity=1,r(i.items[t],e);t=e.startingItem-1;for(let e=-1;e>=-1*i.leftItemsCount;e--)t>0?t-=1:t=i.totalItems-1,i.items[t].style.opacity=1,r(i.items[t],e)}()}))},this.next=function(){o("forward")},this.prev=function(){o("backward")},this.reload(t),document.addEventListener("click",(t=>{t.target.classList[1]===e.leftButton&&(i.currentDirection="backward",a()),t.target.classList[1]===e.rightButton&&(i.currentDirection="forward",a()),null!=e.switchOrientationButton&&t.target.classList[1]===e.switchOrientationButton&&("vertical"===e.orientation?e.orientation="horizontal":e.orientation="vertical",a())}))}}window.onload=()=>{new PerspectiveCarousel};